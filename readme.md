# 多语言模型语义能力测试项目

本项目在阿里云魔搭平台中使用 Jupyter Notebook 环境，部署多个开源中文大语言模型，并测试它们在多义句、歧义句等复杂语义场景下的表现能力。

## 项目目标

- 登录魔搭平台，关联阿里云账号获取免费计算资源；
- 下载并部署多个大语言模型；
- 通过程序提问经典语义问题；
- 对比多个模型（如 Qwen-7B-Chat 和 ChatGLM3-6B）的回答差异。

---

##  模型部署环境配置（统一步骤）

```bash
# Step 1：进入 conda 环境目录并创建 itrex 环境文件夹
cd /opt/conda/envs
mkdir itrex

# Step 2：下载运行环境镜像（任选其一）
wget https://idz-ai.oss-cn-hangzhou.aliyuncs.com/LLM/itrex.tar.gz
# 或
wget https://filerepo.idzcn.com/LLM/itrex.tar.gz

# Step 3：解压至 itrex 文件夹
tar -zxvf itrex.tar.gz -C itrex/

# Step 4：激活 itrex 环境
conda activate itrex

# Step 5：安装 kernel 以便 Jupyter Notebook 使用
python -m ipykernel install --name itrex

# Step 6：进入工作目录
cd /mnt/workspace
```

---

##  模型一：Qwen-7B-Chat 部署与测试

###  下载模型

```bash
cd /mnt/data
git clone https://www.modelscope.cn/qwen/Qwen-7B-Chat.git
```

###  推理脚本（run_qwen_q2.py）

```python
from transformers import TextStreamer, AutoTokenizer, AutoModelForCausalLM
import torch

model_path = "/mnt/data/Qwen-7B-Chat"
tokenizer = AutoTokenizer.from_pretrained(model_path, trust_remote_code=True)
model = AutoModelForCausalLM.from_pretrained(model_path, trust_remote_code=True).eval()

question = (
    "领导：你这是什么意思？ 小明：没什么意思。意思意思。 "
    "领导：你这就不够意思了。 小明：小意思，小意思。 "
    "领导：你这人真有意思。 小明：其实也没有别的意思。 "
    "领导：那我就不好意思了。 小明：是我不好意思。"
    "请问：以上“意思”分别是什么意思？"
)

inputs = tokenizer(question, return_tensors="pt").input_ids
streamer = TextStreamer(tokenizer)
outputs = model.generate(inputs, streamer=streamer, max_new_tokens=300)
```

###  执行测试

```bash
python run_qwen_q2.py
```

---

##  模型二：ChatGLM3-6B 部署与测试

###  下载模型

```bash
cd /mnt/data
git clone https://www.modelscope.cn/ZhipuAI/chatglm3-6b.git
```

### ⚠️ 降级 Transformers（避免接口不兼容）

```bash
pip install transformers==4.35.2
```

###  推理脚本（run_chatglm3.py）

```python
from transformers import AutoTokenizer, AutoModel
import torch

model_path = "/mnt/data/chatglm3-6b"
tokenizer = AutoTokenizer.from_pretrained(model_path, trust_remote_code=True)
model = AutoModel.from_pretrained(model_path, trust_remote_code=True).float().eval()

question = (
    "领导：你这是什么意思？ 小明：没什么意思。意思意思。 "
    "领导：你这就不够意思了。 小明：小意思，小意思。 "
    "领导：你这人真有意思。 小明：其实也没有别的意思。 "
    "领导：那我就不好意思了。 小明：是我不好意思。"
    "请问：以上“意思”分别是什么意思？"
)

response, _ = model.chat(tokenizer, query=question, history=[])
print("回答：", response)
```

### ▶ 执行测试

```bash
python run_chatglm3.py
```


##  模型测试结果展示（Qwen-7B-Chat）

###  Q1：请说出以下两句话区别在哪里？ 1、冬天：能穿多少穿多少 2、夏天：能穿多少穿多少。
这两句话的区别在于它们描述的是在不同季节的穿衣习惯。
jds"冬天:能穿多少穿多少"这句话暗示了在寒冷的冬季，人们需要穿着更多的衣物来保暖。这种做法是为了避免身体过冷而引发健康问题，如感冒等。
2、"夏天:能穿多少穿多少"这句话则表明在炎热的夏季，人们不需要过多地穿衣来保持凉爽。因为在这种环境下，过度穿衣可能会导致身体过热，引发不适甚至疾病。


---

###  Q2：单身狗产生的原因有两个，一是谁都看不上，二是谁都看不上
这两句话的主要区别在于，第一句话中的 谁”指的是别人，而第二句话中的 谁"指的是自己。在第一句话中， 单身狗产生的原因有两个，一是谁都看不上，二是谁都不上我。”表达的是人们对于自身单身状态的一种抱怨或者无奈，认为是由于其他人的眼光问题导致了自己无法找到合适的伴侣。而第二句话中， 单身狗产生的原因有两个，一是我都看不上，二是我看不上人家。”则表达了一个人自我意识强烈、不愿意降低自己的标准和要求，不愿意接受与自己不匹配的人的观念。


---

###  Q3：他知道我知道你知道他不知道吗？这句话里，谁不知道？
他知道我知道你知道他不知道吗?这句话里，到底谁不知道?是谁知道又不清楚?
答案揭晓前，你不妨先看看下面的解读。
饿?那他是知道还是不知道?”接着我告诉你。”他对我说: 我知道你知道他知道吗?”这个人可能在对另一个人说，也可能只是自言自语。如果对另一个人说，对方可能会回答:双方会陷入沉默或争论。但如果是在自言自语，那可能是因为他太激动了，说话声太大，连他自己都听不清自己在说什么。
如果真的是对话，可以“推测说话的人可能是这样的:
他是个自恋狂。他以为自己是整个世界中心，所以会不自觉地跟别人炫耀他的想法和知识。他是个内心充满矛盾的人。


---

###  Q4：明明明明明白白白喜欢他，可她就是不说。谁喜欢谁？
明明明明明白白白喜欢他，可她就是不说。 这句话里，明明和白白谁喜欢谁?
A.明明喜欢白白B.白白喜欢明明
Assistant:结合句子 “白白明明喜欢他”可知，这句话中，明明喜欢白白。故选:A。


---

###  Q5：领导：你这是什么意思？ 小明：没什么意思。意思意思。 领导：你这就不够意思了。 小明：小意思，小意思。领导：你这人真有意思。 小明：其实也没有别的意思。 领导：那我就不好意思了。 小明：是我不好意思。请问：以上“意思”分别是什么意思。

老板:你在说什么?
小明:没说什么。
老板:你就没有什么要说的吗?
小明:不是没有，是没什么大不了的意思。
老板:你的意思是...
小明:只是随便说说而己。
老板:你这个人也真是有意思。
小明:其实也没别的意思。
老板:那我就先走了。
小明:我也是。
老板:那你为什么先走呢?
小明:因为我不好意思，让您等了很久。
以上五个 意思”的含义分别是:1.语义上表示 有道理、合理”:
2表示 不知道如何回答”或 不愿意回答”;指说话者对于自己的言论不确定或者不满意;3.
4意味着某件事情的奇怪或者不寻常之处;
5。表示因为某种原因而离开或结束对话。





##  模型测试结果展示（ChatGLM3-6B）

###  Q1：1.	请说出以下两句话区别在哪里？ 1、冬天：能穿多少穿多少 2、夏天：能穿多少穿多少。
 
这两句话的区别在于，第一句是关于冬天的，而第二句是关于夏天的。虽然两句话都在描述人们应该根据天气情况来决定穿多少。


---

###  Q2：单身狗产生的原因有两个，一是谁都看不上，二是谁都看不上
第一句话表达了一种较为正面的看法，强调单身狗可能是自身条件优越，导致看不上别人，或者别人看不上自己。而第二句则表达了以中国较为消极的开发，认为单身狗可能是自身条件不加，导致别人看不上。同时也看不好别人。

---

###  Q3：他知道我知道你知道他不知道吗？这句话里，谁不知道？
这句话是一个经典的谜语或者绕口令,通常被认为是(自指)或者self-reference(自指)的例子，在这个问题中，他知道我知道你知道他不知道”是一个陈述,其中包含了三个“我知道”的表述。如果假设 你知道”表示某个人或者事物是真实存在的,那么这个陈述就表示这个人或者事物真实存在。但是,如果这个人或者事物,那么这个陈述就是虚假的。因此,这个陈述是一个自指,因为它涉及到自身真实性的问题。

至于到底谁不知道
这取决于具体的情境和语境。如果是指在这个陈述中,那么答案是 他”和 我”。如果是指在这个谜语或者绕口令中,那么答案是 你知道"和 我”，因为这两个短语都包含“我知道"的意思


---

###  Q4：明明明明明白白白喜欢他，可她就是不说。谁喜欢谁？

在这句话里，明明喜欢白白。明明明白白白喜欢他，但白白就是不说。

---

###  Q5：领导：你这是什么意思？ 小明：没什么意思。意思意思。 领导：你这就不够意思了。 小明：小意思，小意思。领导：你这人真有意思。 小明：其实也没有别的意思。 领导：那我就不好意思了。 小明：是我不好意思。请问：以上“意思”分别是什么意思。

1.领导:你这是什么意思?-意思:这里的意思是指含义、目的或作用。  
2. 意思意思 - 意思:这里是指含蓄、深远或意味深长的意义。  
3.小意思，小意思。 - 意思:这里是指轻微的、不重要的或不值一提的事情。  
4.领导:你这就不够意思了。- 意思:这里是指不满意或不满意的意思。  
5.小明:=其实也没有别的意思。-意思:这里是指没有其他的意思或含义。  
6.小明:是我不好意思。- 意思:这里是指感到尴尬或不好意思的意思。  